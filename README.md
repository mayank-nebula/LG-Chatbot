1. Incremental Feature for a SharePoint Drive
The incremental feature for a SharePoint drive is crucial for maintaining efficiency and ensuring that only newly added or modified files are processed, rather than reprocessing the entire document library. This feature was implemented using a CSV file to track the state of each document, recording metadata such as the last modified date and document ID. By comparing the current state of the SharePoint drive with the CSV file, the system can identify which documents have been updated or added. This allows for targeted processing, reducing the computational load and ensuring that the most recent versions of documents are always used. The incremental feature also helps in maintaining data consistency, as only the relevant documents are re-ingested into the RAG system, minimizing the risk of redundant or outdated data being processed.

2. Handling Situations for Files with Changed Extensions
Handling files with changed extensions, such as a PPT or PPTX file saved as a PDF, presents a unique challenge. In such cases, the system needs to recognize that the file was originally a different format and process it accordingly. This is achieved by first checking the page aspect ratio of the document. If the aspect ratio is consistent with that of a typical PPT or PPTX presentation, the system flags it for special handling. If the document contains pages with varying aspect ratios, the majority aspect ratio is used to determine the original format. Once identified, the system processes the document as a PDF but applies techniques suitable for the original file type. This ensures that the content is correctly extracted and ingested into the RAG system, preserving the integrity of the information.

3. Different Ingestion Techniques for PPT, PPTX, DOC, DOCX, PDF
The ingestion process for different file types—PPT, PPTX, DOC, DOCX, and PDF—requires tailored techniques to accurately extract content. For PPT and PPTX files, the system focuses on extracting text from slides using OCR models like Florence-RCR or TesseractSB, recognizing that these formats often contain rich visual content. Table extraction is handled using models like TabaRouail/detr-doc-table-detection, ensuring that tabular data is preserved and accurately represented. For images, the unstructured PDF image extraction process is employed, followed by summarization using models like OpenBMB, LLAVA-LLaMA, or GPT-4(O). In contrast, DOC and DOCX files are more text-centric, so the focus is on accurate text extraction and structuring. PDFs, depending on their complexity, may require a combination of these techniques, ensuring that all relevant content—text, tables, and images—is ingested into the RAG system.

4. Ingestion for Summary
Creating summaries for documents is a critical part of the RAG system, enabling users to quickly grasp the key points of a document without reading it in full. The ingestion process for summaries involves generating a separate RAG that focuses on extracting and condensing the main ideas from a document. This process starts with extracting the document's content, followed by using natural language processing models to identify the most important information. The extracted content is then summarized into a concise format, which is stored in a separate vector store dedicated to summaries. This summary RAG is particularly useful for answering user queries related to the overarching themes or specific sections of a document, providing a quick and efficient way to retrieve summarized information without needing to parse the entire document.

5. Intent Identification for Query
Intent identification is a crucial aspect of the RAG system, ensuring that user queries are accurately interpreted and directed to the appropriate resources. The process begins with analyzing the query to determine the user's intent, which could range from seeking specific information within a document to requesting a summary or clarification of a particular point. Advanced natural language processing techniques are employed to parse the query and match it with the relevant content within the document corpus. By understanding the user's intent, the system can provide more accurate and relevant responses, enhancing the overall user experience. This process is essential for making the RAG system intuitive and responsive, allowing users to interact with the system in a natural and efficient manner.

6. User-Based Access Control for Files
Implementing user-based access control is essential for ensuring that only authorized users can access specific documents within the RAG system. This feature is particularly important when dealing with sensitive or confidential information stored on a SharePoint drive. The system uses a combination of user roles and permissions to control access to documents. When a user submits a query, the system first checks their credentials and permissions to determine which documents they are allowed to access. This ensures that the response provided by the RAG system only includes information from documents the user has permission to view. By enforcing strict access controls, the system maintains data security and confidentiality, while still providing users with the information they need.

7. Streaming Response
The streaming response feature in the RAG system is designed to provide users with immediate feedback, even as the system continues to process their query. This feature is particularly useful when dealing with large documents or complex queries that may take time to process fully. Instead of making the user wait for the entire response, the system begins streaming the first part of the response as soon as it is available. This not only improves the user experience by reducing perceived wait times but also allows users to start interacting with the information as it becomes available. The streaming response is carefully managed to ensure that the information is presented in a coherent and logical order, maintaining the quality and relevance of the data being provided.
